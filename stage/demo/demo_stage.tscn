[gd_scene load_steps=23 format=4 uid="uid://kqkvasn678ry"]

[ext_resource type="Script" uid="uid://d22scmdflkulk" path="res://stage/demo/demo_stage.gd" id="1_3sebb"]
[ext_resource type="TileSet" uid="uid://c6jlxm4wokjti" path="res://stage/demo/tilemap/demo_floor.tres" id="2_ln17t"]
[ext_resource type="PackedScene" uid="uid://c37uogod3vrww" path="res://entity/sapper/sapper.tscn" id="2_w7nxb"]
[ext_resource type="TileSet" uid="uid://deu2u6slac2vq" path="res://stage/demo/tilemap/demo_desert.tres" id="3_jj4g0"]
[ext_resource type="TileSet" uid="uid://2d7hcthqc830" path="res://stage/demo/tilemap/demo_walls.tres" id="3_k46ji"]
[ext_resource type="TileSet" uid="uid://bjea5f63ldn35" path="res://stage/demo/tilemap/demo_acid.tres" id="3_ln17t"]
[ext_resource type="PackedScene" uid="uid://qb3w45t4vdnh" path="res://entity/gun/light/light_gun.tscn" id="4_4royo"]
[ext_resource type="Script" uid="uid://tf36ugicuoyh" path="res://stage/demo/demo_controls.gd" id="4_vte7o"]
[ext_resource type="TileSet" uid="uid://c1xug7auajvfn" path="res://stage/demo/tilemap/demo_dummies.tres" id="5_k46ji"]
[ext_resource type="Script" uid="uid://bd046eokvcnu2" path="res://addons/phantom_camera/scripts/phantom_camera_host/phantom_camera_host.gd" id="9_xrwbm"]
[ext_resource type="Script" uid="uid://bhexx6mj1xv3q" path="res://addons/phantom_camera/scripts/phantom_camera/phantom_camera_2d.gd" id="10_jj4g0"]
[ext_resource type="Script" uid="uid://8umksf8e80fw" path="res://addons/phantom_camera/scripts/resources/tween_resource.gd" id="11_dk5wi"]
[ext_resource type="PackedScene" uid="uid://c44dinhcu2bbt" path="res://entity/friendbot/friendbot.tscn" id="13_dk5wi"]
[ext_resource type="Shader" uid="uid://b4r7p31cdxr82" path="res://stage/demo/shader/anomaly.gdshader" id="14_fxrrq"]
[ext_resource type="Shader" uid="uid://dvroe85kopapo" path="res://stage/demo/shader/chromatic_aberration.gdshader" id="15_xk4ec"]

[sub_resource type="NavigationPolygon" id="NavigationPolygon_jj4g0"]
vertices = PackedVector2Array(307.27344, -276.03125, 398.52344, 388.9375, 106, 74, 106, 6, 90, 6, 90, -74, -178.24219, -277.9922, 26, -106, 42, -74, 42, -90, 26, -90, -38, 54, -38, -38, -10, -54, 6, -54, 6, -38, -22, 70, 54, -38, 54, 54, 38, 54, 38, 70, 6, 70, -22, 106, 6, 106, -228.38281, 386.02344, -38, 70, -54, 54, -54, -38, -38, -54, -22, -54, -58, -106, -58, -90, -74, -90, -74, -74, -90, -74, -294.4297, -235.74219, -90, 90, -74, 90, -74, 106, 74, 106, 74, 90, 90, 90, 90, 74, -456.1797, 13.171875, -10, -106, -22, -106)
polygons = Array[PackedInt32Array]([PackedInt32Array(0, 1, 2, 3), PackedInt32Array(3, 4, 5, 0), PackedInt32Array(6, 0, 5, 7), PackedInt32Array(5, 8, 9), PackedInt32Array(9, 10, 7), PackedInt32Array(11, 12, 13, 14, 15, 16), PackedInt32Array(15, 17, 18, 19), PackedInt32Array(19, 20, 21, 15), PackedInt32Array(22, 21, 23, 24), PackedInt32Array(21, 22, 16, 15), PackedInt32Array(16, 25, 11), PackedInt32Array(11, 26, 27, 12), PackedInt32Array(12, 28, 29), PackedInt32Array(30, 31, 32, 6), PackedInt32Array(6, 32, 33, 34, 35), PackedInt32Array(36, 37, 38), PackedInt32Array(39, 40, 41, 1), PackedInt32Array(41, 42, 2, 1), PackedInt32Array(39, 1, 24, 23), PackedInt32Array(38, 22, 24), PackedInt32Array(38, 24, 43, 36), PackedInt32Array(36, 43, 35, 34), PackedInt32Array(13, 12, 29), PackedInt32Array(44, 13, 29, 45), PackedInt32Array(45, 30, 6), PackedInt32Array(44, 45, 6), PackedInt32Array(7, 44, 6), PackedInt32Array(7, 5, 9)])
outlines = Array[PackedVector2Array]([PackedVector2Array(-468, 13, -234, 396, 410, 399, 316, -286, -180, -288, -301, -244)])
parsed_collision_mask = 1

[sub_resource type="Resource" id="Resource_fxrrq"]
script = ExtResource("11_dk5wi")
duration = 0.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_xk4ec"]
shader = ExtResource("14_fxrrq")
shader_parameter/anomalyPower = 0.10000000149012
shader_parameter/anomalySpeed = 0.40000000596048

[sub_resource type="Gradient" id="Gradient_3p7ug"]
offsets = PackedFloat32Array(0.3660221, 1)
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_y18u6"]
gradient = SubResource("Gradient_3p7ug")
fill = 1
fill_from = Vector2(0.5, 0.5)
fill_to = Vector2(0.8119658, 0.8247863)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_3p7ug"]
shader = ExtResource("15_xk4ec")
shader_parameter/aberration_distance = 0.00800000038
shader_parameter/extract_color_left = Color(0.78751117, 0.30806148, 0.7475481, 1)
shader_parameter/extract_color_right = Color(0.99479204, 0.91009253, 0.8521871, 1)

[sub_resource type="PlaceholderTexture2D" id="PlaceholderTexture2D_y18u6"]

[node name="DemoStage" type="Node2D"]
script = ExtResource("1_3sebb")

[node name="Map" type="Node2D" parent="."]

[node name="NavigationRegion2D" type="NavigationRegion2D" parent="Map"]
navigation_polygon = SubResource("NavigationPolygon_jj4g0")

[node name="TileMapFloor" type="TileMapLayer" parent="Map/NavigationRegion2D"]
position = Vector2(-82, -12)
tile_map_data = PackedByteArray("AAD/////AwABAAEAAAAAAP//AwABAAEAAAD//wAAAwABAAEAAAAAAAAAAwABAAEAAAABAAAAAwABAAEAAAABAP//AwABAAEAAAABAP7/AwABAAEAAAAAAP7/AwABAAEAAAD///7/AwABAAEAAAD+/wAAAwABAAEAAAD+////AwABAAEAAAD+//7/AwABAAEAAAAEAAIAAwADAAMAAAAEAAEAAwADAAEAAAAEAAAAAwADAAEAAAAEAP//AwADAAEAAAAEAP7/AwADAAEAAAAEAP3/AwADAAEAAAAEAPz/AwADAAAAAAADAAIAAwACAAMAAAADAAEAAwABAAEAAAADAAAAAwABAAEAAAADAP//AwABAAEAAAADAP7/AwABAAEAAAADAP3/AwABAAEAAAADAPz/AwABAAAAAAACAAIAAwACAAMAAAACAAEAAwABAAEAAAACAAAAAwABAAEAAAACAP//AwABAAEAAAACAP7/AwABAAEAAAACAP3/AwABAAEAAAACAPz/AwABAAAAAAABAAIAAwACAAMAAAABAAEAAwABAAEAAAABAP3/AwABAAEAAAABAPz/AwABAAAAAAAAAAIAAwACAAMAAAAAAAEAAwABAAEAAAAAAP3/AwABAAEAAAAAAPz/AwABAAAAAAD//wIAAwACAAMAAAD//wEAAwABAAEAAAD///3/AwABAAEAAAD///z/AwABAAAAAAD+/wIAAwACAAMAAAD+/wEAAwABAAEAAAD+//3/AwABAAEAAAD+//z/AwABAAAAAAD9/wIAAwACAAMAAAD9/wEAAwABAAEAAAD9/wAAAwABAAEAAAD9////AwABAAEAAAD9//7/AwABAAEAAAD9//3/AwABAAEAAAD9//z/AwABAAAAAAD8/wIAAwAAAAMAAAD8/wEAAwAAAAIAAAD8/wAAAwAAAAIAAAD8////AwAAAAIAAAD8//7/AwAAAAIAAAD8//3/AwAAAAIAAAD8//z/AwAAAAAAAAA=")
tile_set = ExtResource("2_ln17t")

[node name="TileMapDesert" type="TileMapLayer" parent="Map/NavigationRegion2D"]
tile_map_data = PackedByteArray("AAAEAAEAAAACAAAAAAAEAAAAAAAGAAAAAAAEAP//AAAGAAAAAAADAAEAAAACAAAAAAADAAAAAAAGAAAAAAADAP//AAAGAAAAAAADAP7/AAACAAAAAAACAAMAAAACAAAAAAACAAIAAAAGAAAAAAACAAEAAAACAAAAAAACAAAAAAAEAAAAAAACAP//AAAAAAAAAAACAP7/AAACAAAAAAACAP3/AAAGAAAAAAABAAMAAAAAAAAAAAABAAIAAAAEAAAAAAABAAEAAAAGAAAAAAABAAAAAAAEAAAAAAABAP//AAAAAAAAAAABAP7/AAAEAAAAAAABAP3/AAAEAAAAAAAAAAMAAAACAAAAAAAAAAIAAAACAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAAAAAP//AAAGAAAAAAAAAP7/AAAEAAAAAAAAAP3/AAAAAAAAAAD//wMAAAACAAAAAAD//wIAAAACAAAAAAD//wEAAAAEAAAAAAD//wAAAAAGAAAAAAD/////AAACAAAAAAD///7/AAAAAAAAAAD///3/AAAAAAAAAAD+/wMAAAAAAAAAAAD+/wIAAAACAAAAAAD+/wEAAAAGAAAAAAD+/wAAAAAAAAAAAAD+////AAACAAAAAAD+//7/AAAEAAAAAAD+//3/AAAAAAAAAAD9/wIAAAAGAAAAAAD9/wEAAAAEAAAAAAD9/wAAAAAAAAAAAAD9////AAAGAAAAAAD9//7/AAAGAAAAAAD8/wEAAAACAAAAAAD8/wAAAAAGAAAAAAD8////AAAAAAAAAAADAAIAAAAAAAAAAAA=")
tile_set = ExtResource("3_jj4g0")

[node name="TileMapAcid" type="TileMapLayer" parent="Map/NavigationRegion2D"]
tile_map_data = PackedByteArray("AAAEAAIAAAAAAAAAAgADAAIAAAAAAAAAAgADAAEAAAAAAAAAAgAEAAEAAAAAAAAAAgACAAMAAAAAAAAAAgADAAMAAAAAAAAAAgABAAMAAAAAAAAAAgAAAAQAAAAAAAAAAgABAAQAAAAAAAAAAgACAAQAAAAAAAAAAgA=")
tile_set = ExtResource("3_ln17t")

[node name="TileMapDesertObjects" type="TileMapLayer" parent="Map/NavigationRegion2D"]
tile_map_data = PackedByteArray("AAADAAEAAAACAAIAAAAEAAAAAAAAAAIAAAD8////AAACAAIAAAACAP3/AAAAAAIAAAABAAMAAAAGAAIAAAAAAAMAAAAEAAIAAAADAAAAAAAEAAIAAAADAP7/AAAGAAIAAAABAP3/AAAEAAIAAAD8/wEAAAACAAQAAAAAAP7/AAAAAAQAAAD+/wMAAAAGAAQAAAA=")
tile_set = ExtResource("3_jj4g0")

[node name="TileMapWalls" type="TileMapLayer" parent="Map/NavigationRegion2D"]
tile_map_data = PackedByteArray("AAD7//z/AgAEAAAAAAD7//3/AgAAAAEAAAD7//7/AgAAAAEAAAD7////AgAAAAEAAAD7/wAAAgAAAAEAAAD7/wEAAgAAAAEAAAD7/wIAAgAAAAEAAAD7/wMAAgAAAAEAAAADAPz/AgACAAMAAAAEAPz/AgAGAAAAAAAEAP3/AgAAAAEAAAAEAP7/AgAAAAEAAAAEAP//AgAAAAEAAAAEAAAAAgAAAAEAAAAEAAEAAgAEAAIAAAAFAAEAAgAGAAAAAAAFAAIAAgAAAAEAAAAFAAMAAgAGAAIAAAAEAAMAAgAEAAAAAAAEAAQAAgAGAAIAAAADAAQAAgAEAAAAAAADAAUAAgAGAAIAAAACAAUAAgACAAMAAAABAAUAAgABAAMAAAD9//r/AgAAAAAAAAD9//v/AgAGAAIAAAD8//v/AgAEAAAAAAD8//z/AgAGAAIAAAAAAPr/AgAAAAAAAAAAAPv/AgAEAAIAAAABAPv/AgAGAAAAAAABAPz/AgAEAAIAAAACAPz/AgACAAMAAAD7/wQAAgAEAAIAAAD8/wQAAgAGAAAAAAD8/wUAAgAEAAIAAAD9/wUAAgADAAMAAAA=")
tile_set = ExtResource("3_k46ji")

[node name="TileMapEnemies" type="TileMapLayer" parent="Map/NavigationRegion2D"]
tile_map_data = PackedByteArray("AAD9/wIAAAAAAAAAAQADAAIAAAAAAAAAAQADAAEAAAAAAAAAAQADAAAAAAAAAAAAAQADAP//AAAAAAAAAQD//wQAAAAAAAAAAgA=")
tile_set = ExtResource("5_k46ji")

[node name="Sapper" parent="." instance=ExtResource("2_w7nxb")]
unique_name_in_owner = true
position = Vector2(-15, -36)

[node name="LightGun" parent="Sapper" instance=ExtResource("4_4royo")]
unique_name_in_owner = true

[node name="DemoControls" type="Node2D" parent="."]
script = ExtResource("4_vte7o")

[node name="SpawnDummyTimer" type="Timer" parent="."]
wait_time = 3.0
autostart = true

[node name="Camera2D" type="Camera2D" parent="."]
physics_interpolation_mode = 1
position = Vector2(-15, -36)
zoom = Vector2(7, 7)

[node name="PhantomCameraHost" type="Node" parent="Camera2D"]
process_priority = 300
process_physics_priority = 300
script = ExtResource("9_xrwbm")
metadata/_custom_type_script = "uid://bd046eokvcnu2"

[node name="PhantomCamera2D" type="Node2D" parent="." node_paths=PackedStringArray("follow_target")]
top_level = true
position = Vector2(-15, -36)
script = ExtResource("10_jj4g0")
follow_mode = 5
follow_target = NodePath("../Sapper")
zoom = Vector2(7, 7)
tween_resource = SubResource("Resource_fxrrq")
follow_damping = true
follow_damping_value = Vector2(0.2, 0.2)
dead_zone_width = 0.07
dead_zone_height = 0.04
metadata/_custom_type_script = "uid://bhexx6mj1xv3q"

[node name="FriendBot" parent="." instance=ExtResource("13_dk5wi")]

[node name="Anomaly" type="Node2D" parent="."]
position = Vector2(-96, 73)

[node name="Sprite2D" type="Sprite2D" parent="Anomaly"]
material = SubResource("ShaderMaterial_xk4ec")
position = Vector2(235, -58)
texture = SubResource("GradientTexture2D_y18u6")

[node name="ChromaticAbberation" type="Node2D" parent="."]

[node name="Sprite2D" type="Sprite2D" parent="ChromaticAbberation"]
material = SubResource("ShaderMaterial_3p7ug")
position = Vector2(-32, -2)
scale = Vector2(55.280006, 55.280006)
texture = SubResource("PlaceholderTexture2D_y18u6")

[connection signal="is_moving_changed" from="DemoControls" to="." method="_on_demo_controls_is_moving_changed"]
[connection signal="move_direction_changed" from="DemoControls" to="." method="_on_demo_controls_move_direction_changed"]
[connection signal="pointer_click" from="DemoControls" to="." method="_on_demo_controls_pointer_click"]
[connection signal="pointer_position_changed" from="DemoControls" to="." method="_on_demo_controls_pointer_position_changed"]
[connection signal="roll_pressed" from="DemoControls" to="." method="_on_demo_controls_roll_pressed"]
[connection signal="timeout" from="SpawnDummyTimer" to="." method="_on_spawn_dummy_timer_timeout"]
